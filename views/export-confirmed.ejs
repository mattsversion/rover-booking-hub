<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Confirmed Bookings</title>
  <style>
    * { box-sizing: border-box; }
    :root {
      --ink:#111; --muted:#666; --line:#e7e7e7; --chip:#ddd; --bg:#fafafa;
      --card:#fff; --accent:#6c5ce7; --accent-ink:#fff;
    }
    body { font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin:0; color:var(--ink); background:var(--bg); }
    .wrap { padding: 24px; max-width: 1024px; margin: 0 auto; }
    header { display:flex; align-items:baseline; gap:12px; margin-bottom:16px; }
    h1 { margin:0; font-size:24px; letter-spacing:.2px; }
    .sub { color:var(--muted); font-size:12px; }
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .card {
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 16px;
      background: var(--card);
      box-shadow: 0 1px 0 rgba(0,0,0,.02);
      break-inside: avoid;
    }
    .row { display:flex; justify-content:space-between; gap:8px; align-items:flex-start; }
    .name { font-weight:700; font-size:16px; }
    .handle { color:var(--muted); font-size:12px; }
    .muted { color:var(--muted); font-size:12px; }
    .chips { margin-top:6px; display:flex; gap:6px; flex-wrap:wrap; }
    .chip { display:inline-block; font-size:11px; padding:2px 8px; border-radius:999px; border:1px solid var(--chip); background:#fff; }
    .chip.accent { background:var(--accent); color:var(--accent-ink); border-color:transparent; }
    .section-title { font-weight:600; font-size:12px; margin-top:10px; letter-spacing:.2px; }
    ul { margin:4px 0 0 16px; padding:0; }
    @page { size: Letter; margin: 14mm; }
    @media print {
      body { background:#fff; }
      .wrap { padding:0; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Confirmed Bookings</h1>
      <div class="sub">Generated: <%= typeof fmt==='function' ? fmt(generatedAt) : new Date(generatedAt).toLocaleString() %></div>
    </header>

    <% if (!bookings.length) { %>
      <div class="muted">No confirmed bookings.</div>
    <% } %>

    <div class="grid">
      <% bookings.forEach(b => { 
           const title = b.contactLabel || b.clientName || b.clientPhone || b.roverRelay || '—';
           const handle = b.clientPhone || b.roverRelay || '';
        %>
        <div class="card">
          <div class="row">
            <div class="name"><%= title %></div>
            <div class="handle"><%= handle %></div>
          </div>

          <div class="chips">
            <span class="chip accent"><%= b.serviceType || 'Unspecified' %></span>
            <span class="chip">dogs: <%= b.dogsCount || 1 %></span>
            <span class="chip">start: <%= typeof fmt==='function' ? fmt(b.startAt) : new Date(b.startAt).toLocaleString() %></span>
            <span class="chip">end: <%= typeof fmt==='function' ? fmt(b.endAt) : new Date(b.endAt).toLocaleString() %></span>
          </div>

          <div class="section-title">Pets</div>
          <% if (b.pets && b.pets.length) { %>
            <ul>
              <% b.pets.forEach(p => { %>
                <li>
                  <b><%= p.name %></b>
                  <span class="muted"><%= p.breed || '' %></span>
                  <% if (p.weightLbs) { %><span class="muted">• <%= p.weightLbs %> lbs</span><% } %>
                  <% if (p.ageYears != null) { %><span class="muted">• <%= p.ageYears %> yr</span><% } %>
                </li>
              <% }) %>
            </ul>
          <% } else { %>
            <div class="muted">—</div>
          <% } %>

          <% if (b.notes) { %>
            <div class="section-title">Notes</div>
            <div><%= b.notes %></div>
          <% } %>
        </div>
      <% }) %>
    </div>
  </div>
</body>
</html>
